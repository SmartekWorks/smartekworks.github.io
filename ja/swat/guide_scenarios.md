シナリオ作成
===

ここでは、SWATナレッジベースでシナリオやケースの作成方法を説明します。

プロジェクト、テストセットの作成
---

#### プロジェクトの作成

SWATは、テストセットを管理するするためにプロジェクトを使用しています。

1. サービス設定メニューから**プロジェクト管理**を開きます。
2. <span class="glyphicon glyphicon-plus"></span>ボタンをクリックし、新しいプロジェクト作成します。
3. **番号**と**タイトル**を記入し、新規をクリックします。
4. テストメニューから**プロジェクト**画面を開き、新しいプロジェクトが作成されていることを確認します。

#### テストセットの作成

テストセットはシナリオの実行や課題を管理するためのメインコンテナです。テストセット単位でシナリオの実行設定を予めセットできます。また、テストセット単位でテストケースのインポート／エクスポートができます。

1. テストメニューから**プロジェクト**を開きます。
2. その下に新しく作成したプロジェクトを選択し、**新規テストセットの作成**をクリックします。
3. **番号**と**タイトル**を記入し、新規をクリックします。
5. テストセット作成後、このテストセットの**シナリオ一覧**画面が表示されます。 
6. 番号`SG0001`のシナリオグループがデフォルトで作成されることが確認できます。

#### シナリオグループについて

シナリオグループは、テストセット内のシナリオをグループします。主な目的はシナリオを分類することで、タグを付けることでテストセット内のシナリオをフィルタリングすることができます。

Hint: AOPスタイルのインターセプタが動くシナリオグループを定義するために、`before`、`after`のような特別なタグを使うことができます。 

シナリオの作成
---

良いテストシナリオを設計することは決して容易ではないが、SWATでシナリオを作成することは簡単です。

1. 既に作成したテストセットの**シナリオ一覧**画面を開きます。
2. シナリオグループ`SG0001`の右側<span class="caret"></span>をクリックし、**シナリオ追加**を選択すると**シナリオビルダー** 画面が表示されます。 
3. **シナリオビルダー** は、3つのエリアに分かれます。
 * **左エリア**: ナレッジベースからシステムオペレーション、フロー、画面と画面オペレーションが表示されるエリアです。
 * **右上エリア**: シナリオを作成するエリアです。
 * **右下エリア**: シナリオの個々のパラメータや説明を含むプロパティをセットするエリアです。
4. システムオペレーションの **URLに遷移**は、新しいシナリオを作成する際に自動的に挿入されます。それによってブラウザを立ち上げてテストサイトのURLにアクセスします。
5. シナリオ作成にあたり、左エリアからいくつかのシステムオペレーション、フロー、画面オペレーションをドラッグし、右エリアへドロップしシナリオを作成します。 
6. それぞれのオペレーションでは、実行させるためのデータをパラメータにセットする必要があります。
7. シナリオ作成エリアの上にあるタイトルボックスにタイトルを入力し、**新規**ボタンをクリックしシナリオを完了させます。
8. **シナリオ一覧**画面では、シナリオグループ`SG0001`配下に新しく作成したシナリオが確認できます。

Hint: 検索ボックス横の<span class="glyphicon glyphicon-eye-open"></span>ボタンをクリックすると、システムオペレーション、フロー、画面オペレーションのヘルプ、概要、プレビューが参照できます。

サンプルシナリオの作成
---

1. 新しいシナリオの**シナリオビルダー**で、システムオペレーションの**URLへ遷移**をクリックします。
2. **サイト**で`Bing`を選択すると、*Bing*のホームページへアクセスすることを意味します。その下の**URL**はブランクのままにします。
3. 左エリアでサイトを*Bing*サイトへ切り替えると、*Bing*と*BingSA*画面が確認できます。
4. シナリオ作成エリアへ*Bing*下の*検索*オペレーションをドラッグ＆ドロップします。オペレーションはシナリオに追加され、アクティブされます。 
5. このオペレーションのプロパティの<span class="glyphicon glyphicon-th-list"></span>タブで、**Enter your search ...**のテキストボックスが検索ボックスを指し、**アクション選択**はこのオペレーション下の全てのアクションを指します。（このオペレーションには一つの検索ボタンしかありません。）
6. テキストボックスに直接キーワードを入力することができますが、ここでは変数を使用する方が良いでしょう。よって、**Enter your search ...**への入力は`@{Keyword}`このように指定ください。（変数の利用方法の詳細は[画面オペレーション](ref_web_operation.md#Using_Variable) を参照ください。)
7. サンプルシナリオでは、*検索*ボタンクリックの代わりに検索アシスタントの候補項目を選択する必要があります。そこで、パラメータを無視するように**アクション選択**の次のチェックボックスをオフにする必要があります。(パラメータを無視する方法の詳細は[画面オペレーション](ref_web_operation.md#Ignoring_Parameter)を参照ください。)
8. *BingSA*下の*Suggestion List*をドラッグ＆ドロップでシナリオ作成エリアへ、下段に**sa_list**のセレクトボックスが表示されます。リストの内容は前にインポートしたナレッジページからです。
9. リストは入力に応じ変更されるため、<span class="glyphicon glyphicon-refresh"></span>アイコン（データ入力モードの切り替え）を二度クリックし、リストを**インデックスクエリモード**にします。フィールドへの入力値を引数`@{Index}`とし、ケース実行時にここの引数にセットされる何番目の項目を選択する意味します。（データ入力モードの詳細はここを[画面オペレーション](ref_web_operation.md#Querying_Modes)参照ください。）
10. これでサンプルシナリオの作成は終了です。

シナリオへケースを追加
---

シナリオで変数設定をしている場合、シナリオ毎に異なるケースとして異なるデータセットを追加することができます。データをシナリオから分離することで、データバリデーションテストを簡単に実施できます。

1. 既に作成したテストセットの**シナリオ一覧**画面を開きます。 
2. 新しく作成したシナリオ`S0001`の右端の<span class="caret"></span>をクリックし、**ケースを追加**を選択します。ケース作成・編集のダイアログが開き、シナリオで定義した変数名これら**タイトル**、 **Keyword**、**Index**を設定します。
3. 何か好きなタイトルを入力します。 **Keyword**には`automation`とし、**Index**には`2`とします。これらの意味は、検索ボックスに`automation`を入力、候補リストの2番目の候補を選択することを指します。
4. 上記手順を繰り返えしで、**Keyword**と**Index**に`test`と`-1`を設定します。このケースの中で候補リストの最後のものを選びます。

Hint: Excelフォーマットでテストセットのケーステーブルを出力やインポートすることができます。これを用いることで、Excel上で簡単にケースの追加、変更、削除ができます。

次へ
----

ここでシナリオとケースの作成方法を説明しました。次は実行サービスとしてこれらのケースを実行させます。

[テストケース実行](guide_execution.md)へ。