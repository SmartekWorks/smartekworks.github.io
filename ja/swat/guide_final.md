実プロジェクトでの利用
===

ここでは実プロジェクトでSWATを利用する際に知る必要なあることを述べます。

サイトの構築
---

実プロジェクトを導入する際に、まずそれを対応するサイトを構築する必要があります。

通常のプロジェクトでは１サイトですべてのアプリの画面をまとめることができますが、下記の場合複数サイトを構築する必要があります。

* 複数物理的なサイトを跨いてテストを行う場合。
* 同じサイトの配下に複数実装が違う論理的なサイトが存在する場合、例えば、管理者エリアと利用者エリアがそれぞれ違う作りである場合。

サイトをうまく構築できると、画面ナレッジの管理や、シナリオ実行のセッティングなどが楽になります。

画面ナレッジプレビューの設定
---

画面ナレッジをサイトにインポートしますと、画面ナレッジ一覧とかで画面をプレビューすることができます。

画面ナレッジプレビューは、ナレッジ管理とシナリオ作成に非常に有効です。ただし、通常、プレビューではCSSが効きません。なぜならHTMLソースだけをインポートするからです。その場合、リモートリソースを使用するように設定をすることが必要です。

Note: `https`を使ってSWATサーバーへアクセスする場合、`http`のリソースにアクセスできません。SWATのサービス設定メニューから**サイト設定**画面でSWATに必要なリソースをアップロードし、リモートリソースとして利用することが必要です。

#### リソースURLの分析

ブラウザの開発ツールや、*Firebugs*などの拡張機能でプレビューフレーム内のHTMLソースをチェックします。以下のようなURL記述があります。

* `http://www.bing.com/...`: このタイプのURLは、SWATプレビューで動作するので、何か特別な処置は必要はありません.
* `/images/search...`: このタイプのURLは、プレビューで`Bing`の代わりにSWATのサービスドメインを使い、 `http://www.bing.com/`をドメインに追加する必要があります。

#### サイト設定の変更

1. SWATのサービス設定メニューから**サイト設定**画面を開き、左側に表示されている`Bing`サイトを選択します。
2. **URLプレビュー**に`http://www.bing.com/`を入力すれば、`/images/search...`.を`http://www.bing.com/`に追加します。
3. 設定を保存し、**画面ナレッジ**のプレビューで画面イメージを確認します。

#### 相対的URLの取扱

HTMLの`img/a.png`, `..img/a.css`のような相対的なURLの記述方法があります。このような場合、算出された絶対URLにURL全体を変換しなければなりません。

1. サービス設定メニューから**サイト設定**を開きます。
2. **プレビュー用ルール**の**編集**ボタンをクリックし、プレビュー用置換ルール画面が表示されます。 
3. ここでのルールは、JSONマップのリストです。キーは置換元文字列、バリューは置換先文字列です。例えば、
```json
[
	{"img/":"http://www.sample.com/a/img/"},
	{"../img/":"http://www.sample.com/a/img/"}
]
```
4. ダイアログを閉じた後は必ず設定の保存をしてください。

画面ナレッジのチューニング
---

SWATはナレッジルールを利用して、様々のオペレーションをHTMLから解析することになります。デフォルトルールでたくさんのHTMLページを対応できますが、実プロジェクトを導入する際に解析結果が期待と異なるケースがあります。

デフォルトルールで幾つか典型的な画面をインポートした後に、画面ナレッジチューニングを行うことお勧めします。

先ほどの[画面ナレッジカスタマイズ](guide_tuning.md)からすでにチューニングの仕方を分かった思います。ここで、実プロジェクトでのチューニングのヒントをまとめます。

* 対象WebアプリがJavaScript GUIフレームワーク（例えば**jQuery UI**, **Kendo UI**, **ExtJS**など）ベースの場合、SWATサポートにコンタクトしてください。それらのフレームワークを対応するルールを提供します。
* 画面の共通部（例えばヘッダー、フッター、メニュー）をまずチューニング対象として行うと、他のオペレーションと混ぜることをしないので、お勧めします。
* デフォルトルールではHTMLタグのコンテキストを含めて解析を行っていることで、関連ノードをまとめることがよくあります。しかし、実装によって、このようなまとめ方が必ずしも期待しているわけではありません。この観点でデフォルトの解析結果ををレビューするのがよいです。

フローを設計
---

実プロジェクトのサンプルシナリオできて、本格的にテスト設計に入るまでに、フローの設計をお勧めします。詳細については[フローの活用](article_flow.md)を参照してください。ここではいくつかのヒントを書きます。

* 共通的な画面の操作の流れ（例えばログイン、ログアウト、メニュー操作など）をフローにまとめます。
* 単なる操作の流れよりは、業務意味を持つフロー、フローのパラメータを設計するのが効率的です。例えば、*振り込み元*、*振り込み先*、*金額*のパラメータを持つ*振り込み*フローがいろんなシナリオにわかりやすく呼び出せます。

テスト自動化を楽しもう
---

様々な状況でSWATを使いこなすにはノウハウ集を参照ください。また、仕様の詳細を知りたい場合は、リファレンスを参照ください。

テスト自動化を楽しもう。
