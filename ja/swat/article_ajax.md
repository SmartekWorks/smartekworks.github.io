アラートとAJAX対応
===

最近のWebアプリではJavaScriptが非常に重要な要素になっています。それによって作られたアラートや、更に沢山のAJAXによる呼び出しを自動テストで対応しなければけません。

アラート対応
---

JavaScriptの[ポップアップボックス](http://www.w3schools.com/js/js_popup.asp)の共通メッソドにアラートボックス、確認ボックス、プロンプトボックス3種類があります。これらが画面上に表示される場合、ブラウザがユーザーからの操作を待つモードに入ります。そのため、通常の自動実行が中断されます。これらを対応する方法を説明します。

ここではよく使われるアラートを名前にしましたが、他のポップアップボックスも対応しています。

#### ナレッジ対応

1. ナレッジメニューから**画面ナレッジ**を選択します。
2. アラートが出るオペレーションを選択し、 右側の**保存**ボタンの隣の<span class="caret"></span>プルダウンメニューから**カスタマイズ**を選びます。**オペレーション編集**画面が表示されます。
3. アラートをトリガーするノードを選択し、右側のアラートタイムアウトセレクトボックスから適当な間隔の選択肢を選んで、保存します。

Note: `select`、`checkbox`、`radio`、`button group`などのノードの場合、具体的な選択肢のノードの代わりに、該当コレクションノードにアラート設定をするべきです。

#### シナリオ対応

**シナリオビルダー**にアラートトリガーのあるオペレーションを選ぶと、アラート処理を設定できるようになります。設定方法について、[画面オペレーション](ref_web_operation.md#アラート処理)を参照してください。

シナリオ上にアラートの処理を定義すると、実際のシナリオ実行時に該当操作をした後にアラートの表示を待つことになります。決めた間隔にアラートが表示されない場合タイムアウトエラーが発生します。[実行パラメータの設定](setup_execservices.md#実行パラメータの設定)の`ignoreAlertTimeout`でこのエラーを無視することが可能です。

AJAX対応
---

AJAX技術を利用して、Webアプリをリッチにできる反面、テストの自動化が複雑になります。なぜなら、画面のHTMLが動的に変わります。SWATはAJAX画面に対応していますが、注意すべき点があります。

#### 論理画面について

[SWATキャプチャー](setup_tools.md#SWATキャプチャー)を利用するとレスポンスのHTMLではなく現在表示されているHTMLをキャプチャできます。同じ画面であってもAJAXコールによる複数状態の変化を考慮した上で、論理画面を分けれることができます。

#### 実行について

AJAXが非同期に実行される特徴によって、操作中に待ち時間をうまく設計する必要があります。[実行パラメータの設定](setup_execservices.md#実行パラメータの設定)で操作間、オペレーション間の間隔を調整することができるほか、`enableAjaxWait`を利用すると、実行中に自動的にAJAXコールの完了を検知することができます。

Hint: `enableAjaxWait`がうまく動作しない場合（特に古いIEを利用する場合）、シナリオに[ブラウザで待つ](ref_sys_operation.md#オペレーション_-_ブラウザで待つ_) システムオペレーションで明示的に待ち時間を設定することができます。