システムオペレーション
===

システムオペレーションは、ブラウザやシナリオの取扱いをサポートする予め定義されたオペレーションです。

システムオペレーションの使い方
---

システムオペレーションの使用は [Web Operation](ref_web_operation.md#How_to_Use_Web_Operations?)に非常に似ています。 シナリオのフローまたはフローにシステムオペレーションを drag & dropし、オペレーションのためのパラメータを入力します。 しかしながら、これらは、システムオペレーションとWebオペレーション間でいくつかの違いがあることを知る必要があります。:

#### パラメータ

Webオペレーションとは異なり、, システムオペレーションのパラメータは、以下のような特徴を持っていません。:

* 無視するパラメータオプションを使用するか、パラメータを無視する。
* パラメータ入力モードが異なる照会モードで切り替える。
* アラートのオプションは、アラート用のダイアログを処理する。

#### エラーとエビデンス

各システムオペレーションは、独自に予め定義されたエラーやエビデンスを有しています。以下の全てのシステムオペレーションの仕様を参照してください。

#### 変数の使用

* **変数名**パラメータで変数を設定することができません。 これらのパラメータは**設定値**や **APIコール**オペレーションにあります。
* システムオペレーションでセレクトタイプのパラメータをクエリーモードへ切り換えることができないように、**ナビゲーションコントロール**オペレーションで**アクション**のようにフィールドのような種類の変数を設定することはできません。

#### パラメータと操作を無視

* 変数を無視することでシステムオペレーションのパラメータを無視することはできません、しかし but オペレーションで使用されているすべての変数を無視してオペレーション自身を無視することはできます。 
* **ナビゲーションコントロール**や**追加情報**オペレーションのようなシステムオペレーションで変数を使用することができないように、それらの操作を無視することはできません。

オペレーション - URLに遷移
---

現在のブラウザセッションおよびウィンドウ内の特定のURLに移動します。 

##### パラメータ

| パラメータ | 説明
| ---------- | -----------
| サイト       | SWATで管理するサイト。SWATは SWATは、このオペレーションの後、サイトの実行に関する設定を使用します。
| URL        | **Site**のターゲットサーバーURLへの相対URL. ターゲット·サーバーのURLを無視し、`http://`, `https://`, `file://`でから始まる完全なURLを使用することができます。 

##### ノート

* これらにセッションがない場合は、新しいデフォルトのブラウザセッションウィンドウが作成されます。

##### エラー

* ** URL**と**サイト**のターゲットサーバーURLから生成されたURLは、空白または無効です。 (実行中)

##### エビデンス

* スクリーンショット
* HTML

オペレーション - ブラウザで待つ 
---

現在のブラウザセッションやウィンドウ内で短期間待ちます。 javascriptによってトリガアップデートを待ちたいときに、通常はこの操作を必要としています。

##### パラメータ

| パラメータ | 説目
| ---------- | -----------
| 待ち時間（秒）   | 数秒現在のブラウザセッションおよびウィンドウ内で待機します。

##### ノート

* 長時間待つときには、セッションタイムアウトをケアする必要があります。
* クラウド実行サービスでのアイドルタイムアウトは(約90秒)です。 待機時間がタイムアウト時間を超えた場合、実行が中断されます。

##### エラー

* **収録時間**の値は空白か自然数でない値。 (検証と実行中)

##### エビデンス

* スクリーンショット
* HTML

オペレーション - ブラウザ機能
---

ブラウザのナビゲーション制御機能をシミュレートします。

##### パラメータ

| パラメータ | 説明
| ---------- | -----------
| 機能     | ブラウザのナビゲーション制御機能: `進む`, `戻る`, `再読み込み`.

##### ノート

* このシステムオペレーションは現在*Safari*上では動きません。
* ブラウザはフォーム送信後の `戻る` や `再読み込み`のアクション動作を保証していない場合があります。

##### エラー

*  *Safari*でこのシステムオペレーションは実行します。 (実行中)

##### エビデンス

* スクリーンショット
* HTML

オペレーション - ファイル保存
---

最後のオペレーションでダウンロードしたファイルを入手し、エビデンスとして保存します。これはシステムオペレーションを使用する際に少し注意が必要ですので、注意深く*Notes*のパートを読んでください。

Note: シミュレートするための実際のダウンロードやアップロードのアクションは良い方法ではありません。なぜなら、それはOSの機能を伴い不安定なシナリオの原因となります。

##### パラメータ

| パラメータ    | 説明
| ------------- | -----------
| ダウンロード時間（秒）| ダウンロードファイルが完了するまでの待ち時間

##### ノート

* このシステムオペレーションはローカル実行サービスでしか利用できません。
* ファイルが前の操作で、特定のローカルディレクトリにダウンロードし始めたことを確認する必要があります。 ChromeとFirefoxの上で自動ダウンロードのコンフィギュレーションを提供します。 ただし、ファイルダイアログを保存しバイパスするブラウザの設定を必要とし、、他のブラウザで直接ファイルを開くことがないようにする必要があります。
* ローカル実行サービスでダウンロードディレクトリのパスを*ダウンロードDir*にセットする必要があります。 コンフィグレーションを参照ください。[Execution Services](setup_execservices.md#Configuration_File) 

##### エラー

* **収録時間待ち**の値は、ブランクか自然数でない値。(検証と実行中)
* クラウド実行サービスでこのシステムオペレーションは実行します。(実行中)
* ダウンロードファイルは見つけることができません、ダウンロードしたファイルは、、ダウンロードに失敗または無効ダウンロードディレクトリを見つけることができません。(実行中)

##### エビデンス

* ダウンロードファイル

オペレーション - ウィンドウ制御
---

ターゲットウィンドゥを見つけそれを操作します。

##### パラメータ

| パラメータ     | 説明
| -----------    | -----------
| ウィンドウ名    | ターゲットウィンドゥのウインドゥ名。この条件でバイパスするためにブランクのままにします。
| マッチングルール | ターゲットウィンドゥのマッチングルールです。マッチングルールの詳細はここを参照ください。 [Matching & Querying DSL](ref_mq_rule.md#Matching_Rule_DSL) この条件でバイパスするためにブランクのままにします。
| アクション         | `切り替え`は現在のウィンドゥにターゲットウィンドゥを切り替えます。 `閉じる`はターゲットウィンドゥを閉じます。

##### ノート

* もし、**ウィンドゥ名**と**マッチングルール**の両方が指定されたら、両方ともに満足すべきです。 
* もし、**ウィンドゥ名**と**マッチングルール**がブランクなら、現在のウィンドゥがターゲットウィンドゥです。

##### エラー

* **マッチングルール**はこれに準じません。 [Matching & Querying DSL](ref_mq_rule.md#Matching_Rule_DSL). (検証と実行中) 
* ターゲットウィンドゥは見つけることができません。 (実行中)

##### エビデンス

* スクリーンショット
* HTML

オペレーション - 画面検証
---

現在のウィンドゥ画面は予想される画面がかどうかをアサートします。

##### パラメータ

| パラメータ     | 説明
| -----------    | -----------
| マッチングルール | マッチングルールのファーマットで予想。マッチングルールの詳細はこちらを参照ください。 [Matching & Querying DSL](ref_mq_rule.md#Matching_Rule_DSL) アサーションでバイパスするためにブランクのままにします。 

##### ノート

* アサーションオペレーションの唯一のエビデンスは、通常モードでエビデンスのエクスポートに含まれます。よって、シナリオのチェックポイントとして**マッチングルール**をブランクでそれを使用することができます。

##### エラー

* **マッチングルール**はこれに準じません。 [Matching & Querying DSL](ref_mq_rule.md#Matching_Rule_DSL). (in validation and execution) 
* アサーションの失敗 (実行中)

##### エビデンス

* スクリーンショット
* HTML
* JSONテキストフォーマットのオペレーション結果

オペレーション - 画面変数設定
---

変数に現在のウィンドゥ画面からの値を設定してください。以下のオペレーションでパラメータとして使うことができます。

##### パラメータ

| パラメータ    | 説明
| ------------- | -----------
| クエリルール | 問い合せルールのフォーマットで目標値を定義します。問い合わせルールの詳細はこちらを参照ください。 [Matching & Querying DSL](ref_mq_rule.md#Querying_Rule_DSL) 
| 変数名 | 変数名を格納します。


##### エラー

* **問い合わせルール**はブランクかこれに準じます。 [Matching & Querying DSL](ref_mq_rule.md#Querying_Rule_DSL). (検証と実行中) 
* **変数名**はブランクか変数名のルールに準じません。 (検証中)
* **変数名**は前のオペレーションを参照されます。(検証中)
* 問い合わせのターゲットを見つけることができません。 (実行中)

##### エビデンス

* JSONテキストフォーマットのオペレーション結果

オペレーション - 追加エビデンス
---

現在のウィンドゥから追加情報を取得します。画面上のすべて選択可能なオプションリストやURLを含みます。

##### パラメータ

* なし

##### エラー

* なし

##### エビデンス

* JSONテキストフォーマットの追加情報

オペレーション - 外部API呼び出し
---

シナリオ中に、ファイル操作やDBアクセスのような拡張オペレーションを実行するために、Webサービスを呼び出すことができます。仕様に適合する拡張オペレーションとしてエージェントサーバーの構築が必要です。 [Agent API specification](ref_agent_api.md) 詳細はこちらを参照ください。 [DB Access and File Manipulation](article_api_call.md)

##### パラメータ

| パラメータ    | 説明
| ------------- | -----------
| API URL       | APIのURL
| APIパラメータ    | APIのパラメータ、`Key1=Value1&Key2=Value2`のような要求の問合せ文字列フォーマットを使用します。
| 戻り用変数名 | 変数名は、APIの戻り値を結果に格納。 値を設定する必要がない場合は空白のままにしておきます。

##### ノート

* このシステムオペレーションはローカル実行サービス上でしか利用できません。
* **API URL**は統合のセットアップを選択可能なリストとして表示することができます。詳細はこちらを参照ください。 [Setup Tools and Integrations](setup_tools.md#Agent_Server_API_Integration) 
* ターゲットサーバーのAPIはこちらの仕様に準じます。 [Agent API specification](ref_agent_api.md) 

##### エラー

* **変数名**は変数名のルールに準じていません。 (検証中)
* APIリターンは、値を設定する必要があるとき、 `結果`キーに準じていません。 (実行中)
* **API Params**は、問い合わせ文字列フォーマットの要求に準じていません。 (検証と実行中)
* ラウド実行サービスにこのシステムオペレーションを実行する。 (実行中)
* **API URL** と **API Params**を使うことで、APIと正しく通信できません。 (実行中) 

##### エビデンス

* JSONテキストフォーマットの戻り値

オペレーション - 実行中断
---

シナリオを一時停止し、一定の条件で再開。すべてのブラウザセッションを閉じ、シナリオが一時停止されたときに解放されます。

##### パラメータ

| パラメータ     | 説明
| -------------  | -----------
| 中断タイプ     | 特定の時間を一時停止するための`中断時間指定`、特定の日付時刻に起床するための`再開時刻指定`
| 中断時間（分） | 一時停止は分単位。`Sleep`タイプの下で動作します。
| 再開日   | 一時停止したシナリオを再開するための日付 (`当日`、 `翌日`)。`Wake Up`タイプの下で**Wake Up Time**と一緒に動作します。
| 再開時刻   | 一時停止したシナリオを再開するための時間 (時間単位)。. Works under `Wake Up`タイプの下で**Wake Up Date**問いっしょに動作します。

##### ノート

* この操作を実行するときにウェイクアップする日付時刻が既に過ぎている場合は、一時停止はバイパスされます。
* *URLへ*か、**セッション制御**オペレーションを使用して、再開した後、新しいセッションを作成する必要があります。

##### エラー

* **一時停止期間**の値は、`Sleep`タイプの下のブランクか自然数ではありません。 (検証と実行中)

##### エビデンス

* None

オペレーション - セッション制御
---

シナリオでは複数のブラウザセッションを操作します。 1シナリオで1セッションを普通使います。(複数ウィンドゥを持つ) しかしながら、別のブラウザで互いに対話する、複数のユーザーをシミュレートしたい場合、複数セッションが必要です。

##### パラメータ

| パラメータ   | 説明
| ------------ | -----------
| アクション       | 新しいブラウザセッションを作成するための`立ち上げ`、現在のセッションにブラウザセッションを切り替える`切り替え`
| セッション名 | 新しいセッションまたはターゲット·セッションの名前をアクティベート。デフォルトセッションのセッション名は、`default`

##### ノート

* シナリオは一つづつオペレーションを実行し、一度に一つのアクティベートされたセッションを持つことができますます。それに対してのオペレーションを実行する前に他のセッションに切り替える必要があります。
* アクティベートされていないセッションのセッションタイムアウトに注意する必要があります。
* ローカルとクラウドの実行サービスで定義された最大並列セッションがあります。最大値よりも更にあるセッションのシナリオは、実行サービスによって受け入れられません。

##### エラー

* **Session Name**はブランク (検証と実行中)
* 既存**セッション名**で新しいセッションを作成します。 (実行中)
* 非存在**セッション名**のセッションをアクティブにします。 (実行中)

##### エビデンス

* なし

